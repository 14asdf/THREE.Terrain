/**
 * THREE.Terrain.js 1.0.0-17042014
 *
 * @author Isaac Sukin (http://www.isaacsukin.com/)
 * @license MIT License
 */

THREE.Terrain=function(a){var b={easing:THREE.Terrain.NoEasing,heightmap:THREE.Terrain.DiamondSquare,material:null,maxHeight:100,maxVariation:12,minHeight:-100,optimization:THREE.Terrain.NONE,useBufferGeometry:!0,xSegments:63,xSize:1024,ySegments:63,ySize:1024};a=a||{};for(var c in b)b.hasOwnProperty(c)&&(a[c]="undefined"==typeof a[c]?b[c]:a[c]);a.unit=.5*(a.xSize/(a.xSegments+1)+a.ySize/(a.ySegments+1)),a.material=a.material||new THREE.MeshBasicMaterial({color:15623731});var d=new THREE.Scene,e=new THREE.Mesh(new THREE.PlaneGeometry(a.xSize,a.ySize,a.xSegments,a.ySegments),a.material);return e.rotation.x=-.5*Math.PI,a.heightmap instanceof HTMLCanvasElement||a.heightmap instanceof Image?THREE.Terrain.fromHeightmap(e.geometry.vertices,a):"function"==typeof a.heightmap?a.heightmap(e.geometry.vertices,a):window.console&&console.warn&&console.warn("An invalid value was passed for `options.heightmap`: "+a.heightmap),e.geometry.verticesNeedUpdate=!0,e.geometry.normalsNeedUpdate=!0,e.geometry.computeBoundingSphere(),a.useBufferGeometry&&(e.geometry=THREE.BufferGeometryUtils.fromGeometry(e.geometry)),d.add(e),d},THREE.Terrain.NONE=0,THREE.Terrain.GEOMIPMAP=1,THREE.Terrain.GEOCLIPMAP=2,THREE.Terrain.NoEasing=function(a){return a},THREE.Terrain.EaseInOut=function(a){return a*a*(3-2*a)},THREE.Terrain.InEaseOut=function(a){var b=2*a-1;return.5*b*b*b+.5},THREE.Terrain.fromHeightmap=function(a,b){var c=document.createElement("canvas"),d=c.getContext("2d"),e=b.ySegments+1,f=b.xSegments+1,g=b.maxHeight-b.minHeight;c.width=f,c.height=e,d.drawImage(b.heightmap,0,0,c.width,c.height);for(var h=d.getImageData(0,0,c.width,c.height).data,i=0;e>i;i++)for(var j=0;f>j;j++){var k=i*f+j,l=4*k;a[k].z=(h[l]+h[l+1]+h[l+2])/765*g}},THREE.Terrain.Corner=function(a,b){for(var c=b.maxVariation,d=.5*c,e=0,f=b.xSegments+1;f>e;e++)for(var g=0;g<b.ySegments+1;g++){var h=e*f+g,i=(e-1)*f+g,j=e*f+g-1,k=0>i?a[h].z:a[i].z,l=0>j?a[h].z:a[j].z,m=Math.random(),n=.5*(.2>m?k:.4>m?l:k+l),o=b.easing(Math.random())*c-d;a[h].z=THREE.Math.clamp(n+o,b.minHeight,b.maxHeight)}},THREE.Terrain.DiamondSquare=function(a,b){var c=Math.max(b.xSegments,b.ySegments)+1,d=c+1,e=[],f=.5*(b.maxHeight-b.minHeight),g,h,i=b.xSegments+1,j=b.ySegments+1;for(g=0;c>=g;g++)for(e[g]=[],h=0;c>=h;h++)e[g][h]=0;for(var k=c;k>=2;k/=2){var l=Math.round(.5*k),m=Math.round(k),n,o,p,q,r;for(f/=2,n=0;c>n;n+=m)for(o=0;c>o;o+=m)q=b.easing(Math.random())*f*2-f,p=e[n][o]+e[n+m][o]+e[n][o+m]+e[n+m][o+m],p*=.25,e[n+l][o+l]=p+q;for(n=0;c>n;n+=l)for(o=(n+l)%k;c>o;o+=k)q=b.easing(Math.random())*f*2-f,p=e[(n-l+d)%d][o]+e[(n+l)%d][o]+e[n][(o+l)%d]+e[n][(o-l+d)%d],p*=.25,p+=q,e[n][o]=p,0===n&&(e[c][o]=p),0===o&&(e[n][c]=p)}for(g=0;i>g;g++)for(h=0;j>h;h++)a[g*i+h].z=THREE.Math.clamp(e[g][h],b.minHeight,b.maxHeight)},window.noise&&window.noise.perlin&&(THREE.Terrain.Perlin=function(a,b){noise.seed(Math.random());for(var c=b.maxHeight-.5*b.minHeight,d=.5*c,e=0,f=b.xSegments+1;f>e;e++)for(var g=0,h=b.ySegments+1;h>g;g++)a[e*f+g].z=THREE.Math.clamp(b.easing(noise.perlin(e/f,g/h))*c-d,b.minHeight,b.maxHeight)}),window.noise&&window.noise.simplex&&(THREE.Terrain.Simplex=function(a,b){noise.seed(Math.random());for(var c=.5*(b.maxHeight-b.minHeight),d=.5*c,e=0,f=b.xSegments+1;f>e;e++)for(var g=0,h=b.ySegments+1;h>g;g++)a[e*f+g].z=THREE.Math.clamp(b.easing(noise.simplex(e/f,g/h))*c-d,b.minHeight,b.maxHeight)});
//# sourceMappingURL=THREE.Terrain.min.map